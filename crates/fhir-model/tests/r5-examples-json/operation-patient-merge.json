{
  "resourceType": "OperationDefinition",
  "id": "Patient-merge",
  "text": {
    "status": "extensions",
    "div": "\u003cdiv xmlns\u003d\"http://www.w3.org/1999/xhtml\"\u003e\u003cp\u003eURL: [base]/Patient/$merge\u003c/p\u003e\u003cp\u003eParameters\u003c/p\u003e\u003ctable class\u003d\"grid\"\u003e\u003ctr\u003e\u003ctd\u003e\u003cb\u003eUse\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eName\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eScope\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eCardinality\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eType\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eBinding\u003c/b\u003e\u003c/td\u003e\u003ctd\u003e\u003cb\u003eDocumentation\u003c/b\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003esource-patient\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..1\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"references.html#Reference\"\u003eReference\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eA direct resource reference to the \u003cstrong\u003esource\u003c/strong\u003e patient resource (this may include an identifier).\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003esource-patient-identifier\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..*\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"datatypes.html#Identifier\"\u003eIdentifier\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eWhen source-patient-identifiers are provided, the server is expected to perform an internal lookup to identify the source patient record. The server SHALL reject the request if the provided identifiers do not resolve to a single patient record. This resolution MAY occur asynchronously, for example, as part of a review by a user.\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003etarget-patient\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..1\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"references.html#Reference\"\u003eReference\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eA direct resource reference to the \u003cstrong\u003etarget\u003c/strong\u003e patient resource.\u003c/p\u003e\n\u003cp\u003eThis is the surviving patient resource, the target for the merge.\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003etarget-patient-identifier\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..*\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"datatypes.html#Identifier\"\u003eIdentifier\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eWhen target-patient-identifiers are provided, the server is expected to perform an internal lookup to identify the target patient record. The server SHALL reject the request if the provided identifiers do not resolve to a single patient record. This resolution MAY occur asynchronously, for example, as part of a review by a user.\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003eresult-patient\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..1\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"patient.html\"\u003ePatient\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eThe details of the Patient resource that is expected to be updated to complete with and must have the same patient.id and provided identifiers included.\u003c/p\u003e\n\u003cp\u003eThis resource MUST have the link property included referencing the source patient resource.\u003c/p\u003e\n\u003cp\u003eIt will be used to perform an update on the target patient resource.\u003c/p\u003e\n\u003cp\u003eIn the absence of this parameter the servers should copy all identifiers from the source patient into the target patient, and include the link property (as shown in the example below).\u003c/p\u003e\n\u003cp\u003eThis is often used when properties from the source patient are desired to be included in the target resource.\u003c/p\u003e\n\u003cp\u003eThe receiving system may also apply other internal business rules onto the merge which may make the resource different from what is provided here.\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eIN\u003c/td\u003e\u003ctd\u003epreview\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e0..1\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"datatypes.html#boolean\"\u003eboolean\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eIf this is set to true then the merge will not be actually performed; an OperationOutcome will be returned in the Parameters response that will indicate that no merge has occurred and may include other diagnostic info if desired, such as the scale of the merge.\u003c/p\u003e\n\u003cp\u003ee.g. Issue.details.text \u0026quot;Preview only Patient merge - no issues detected\u0026quot;\u003c/p\u003e\n\u003cp\u003ee.g. Issue.diagnostics \u0026quot;Merge would update: 10 years of content or 120 resources\u0026quot;\u003c/p\u003e\n\u003cp\u003eThe resulting target patient resource will also be returned in the result.\u003c/p\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003eOUT\u003c/td\u003e\u003ctd\u003ereturn\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e1..1\u003c/td\u003e\u003ctd\u003e\u003ca href\u003d\"parameters.html\"\u003eParameters\u003c/a\u003e\u003c/td\u003e\u003ctd/\u003e\u003ctd\u003e\u003cdiv\u003e\u003cp\u003eThe status of the response will be one of:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e200 OK - If the merge request doesn\u0027t expect any issues (although warning may be present) for a preview, or was completed without issues if not a preview\u003c/li\u003e\n\u003cli\u003e202 Accepted - The merge request has been accepted and does not expect any issues and will continue processing the merge in the background, and you can monitor the Task for completion\u003c/li\u003e\n\u003cli\u003e400 Bad Request - There are errors in the input parameters that need to corrected\u003c/li\u003e\n\u003cli\u003e422 Unprocessable Entity - Business rules prevent this merge from completing\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThe Parameters resource will include:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe Input parameters to the operation\u003c/li\u003e\n\u003cli\u003eAn OperationOutcome containing errors, warnings, and information messages\u003c/li\u003e\n\u003cli\u003eThe resulting merged Patient resource (or a patient reference if the patient is not committed)\u003c/li\u003e\n\u003cli\u003eOptionally a Task resource to track any additional processing that was required.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/table\u003e\u003cdiv\u003e\u003cp\u003eThere must be exactly 1 source patient, which may  be identified by either the source-patient or source-patient-identifier parameters. Similarly, there must be exactly 1 target patient, identified by either the target-patient or target-patient-identifier parameters. In both cases, either a reference to the patient or a list of identifiers that can be used to identify the patient may be provided, but not both.\u003c/p\u003e\n\u003cp\u003eThe result-patient.id must be the same as the target patient reference (if the patient reference is provided as an input parameter).\u003c/p\u003e\n\u003cp\u003eIf a client needs the server to create a new patient merged from the 2 patient resources, the client should create a new patient record and then call the merge operation to merge each source patient resource into the newly created patient resource.\u003c/p\u003e\n\u003cp\u003eA server may decide to delete the source record, but this is not defined by the standard merge operation, and if this occurs then the target patient\u0027s link property will remain unchanged.\u003c/p\u003e\n\u003c/div\u003e\u003c/div\u003e"
  },
  "extension": [
    {
      "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-fmm",
      "valueInteger": 0
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/structuredefinition-standards-status",
      "valueCode": "trial-use"
    }
  ],
  "url": "http://hl7.org/fhir/OperationDefinition/Patient-merge",
  "version": "5.0.0",
  "name": "Merge",
  "title": "Patient Merge",
  "status": "draft",
  "kind": "operation",
  "experimental": false,
  "date": "2023-03-26T15:21:02+11:00",
  "publisher": "HL7 (FHIR Project)",
  "contact": [
    {
      "telecom": [
        {
          "system": "url",
          "value": "http://hl7.org/fhir"
        },
        {
          "system": "email",
          "value": "fhir@lists.hl7.org"
        }
      ]
    }
  ],
  "description": "The merge operation is used to request two patient resources be merged. One of the two patients is identified as the source and one as the target. The data from the source patient will be merged with the data of the target patient.\r\rThe source Patient resource will be updated to add a new Patient.link reference to the target Patient resource with a link-type of replaced-by. The source Patient will also be updated to have a status of inactive, unless the source Patient resource was deleted.\r\rThe target Patient resource will be updated to add a new Patient.link reference to the source Patient resource with a link-type of replaces unless the source Patient resource is deleted. The target Patient resource must be included in the result-patient parameter if used.",
  "jurisdiction": [
    {
      "coding": [
        {
          "system": "http://unstats.un.org/unsd/methods/m49/m49.htm",
          "code": "001",
          "display": "World"
        }
      ]
    }
  ],
  "affectsState": true,
  "code": "merge",
  "comment": "There must be exactly 1 source patient, which may  be identified by either the source-patient or source-patient-identifier parameters. Similarly, there must be exactly 1 target patient, identified by either the target-patient or target-patient-identifier parameters. In both cases, either a reference to the patient or a list of identifiers that can be used to identify the patient may be provided, but not both.\r\rThe result-patient.id must be the same as the target patient reference (if the patient reference is provided as an input parameter).\r\rIf a client needs the server to create a new patient merged from the 2 patient resources, the client should create a new patient record and then call the merge operation to merge each source patient resource into the newly created patient resource.\r\rA server may decide to delete the source record, but this is not defined by the standard merge operation, and if this occurs then the target patient\u0027s link property will remain unchanged.\r",
  "resource": [
    "Patient"
  ],
  "system": false,
  "type": true,
  "instance": false,
  "parameter": [
    {
      "name": "source-patient",
      "use": "in",
      "min": 0,
      "max": "1",
      "documentation": "A direct resource reference to the **source** patient resource (this may include an identifier).",
      "type": "Reference",
      "targetProfile": [
        "http://hl7.org/fhir/StructureDefinition/Patient"
      ]
    },
    {
      "name": "source-patient-identifier",
      "use": "in",
      "min": 0,
      "max": "*",
      "documentation": "When source-patient-identifiers are provided, the server is expected to perform an internal lookup to identify the source patient record. The server SHALL reject the request if the provided identifiers do not resolve to a single patient record. This resolution MAY occur asynchronously, for example, as part of a review by a user.",
      "type": "Identifier"
    },
    {
      "name": "target-patient",
      "use": "in",
      "min": 0,
      "max": "1",
      "documentation": "A direct resource reference to the **target** patient resource.\r\rThis is the surviving patient resource, the target for the merge.",
      "type": "Reference",
      "targetProfile": [
        "http://hl7.org/fhir/StructureDefinition/Patient"
      ]
    },
    {
      "name": "target-patient-identifier",
      "use": "in",
      "min": 0,
      "max": "*",
      "documentation": "When target-patient-identifiers are provided, the server is expected to perform an internal lookup to identify the target patient record. The server SHALL reject the request if the provided identifiers do not resolve to a single patient record. This resolution MAY occur asynchronously, for example, as part of a review by a user.",
      "type": "Identifier"
    },
    {
      "name": "result-patient",
      "use": "in",
      "min": 0,
      "max": "1",
      "documentation": "The details of the Patient resource that is expected to be updated to complete with and must have the same patient.id and provided identifiers included.\r\rThis resource MUST have the link property included referencing the source patient resource.\r\rIt will be used to perform an update on the target patient resource.\r\rIn the absence of this parameter the servers should copy all identifiers from the source patient into the target patient, and include the link property (as shown in the example below).\r\rThis is often used when properties from the source patient are desired to be included in the target resource.\r\rThe receiving system may also apply other internal business rules onto the merge which may make the resource different from what is provided here.",
      "type": "Patient"
    },
    {
      "name": "preview",
      "use": "in",
      "min": 0,
      "max": "1",
      "documentation": "If this is set to true then the merge will not be actually performed; an OperationOutcome will be returned in the Parameters response that will indicate that no merge has occurred and may include other diagnostic info if desired, such as the scale of the merge.\r\re.g. Issue.details.text \"Preview only Patient merge - no issues detected\"\r\re.g. Issue.diagnostics \"Merge would update: 10 years of content or 120 resources\"\r\rThe resulting target patient resource will also be returned in the result.",
      "type": "boolean"
    },
    {
      "name": "return",
      "use": "out",
      "min": 1,
      "max": "1",
      "documentation": "The status of the response will be one of:\r\r* 200 OK - If the merge request doesn\u0027t expect any issues (although warning may be present) for a preview, or was completed without issues if not a preview\r* 202 Accepted - The merge request has been accepted and does not expect any issues and will continue processing the merge in the background, and you can monitor the Task for completion\r* 400 Bad Request - There are errors in the input parameters that need to corrected\r* 422 Unprocessable Entity - Business rules prevent this merge from completing\r\rThe Parameters resource will include:\r\r* The Input parameters to the operation\r* An OperationOutcome containing errors, warnings, and information messages\r* The resulting merged Patient resource (or a patient reference if the patient is not committed)\r* Optionally a Task resource to track any additional processing that was required.",
      "type": "Parameters"
    }
  ]
}